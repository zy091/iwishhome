import{E as z,m as O}from"./elementPlus-Be5V1zcU.js";import{x as I,r as l,j as B,n as F,w as D,G as N,ag as b,H as d,A as u,M as p,y as C,a6 as L,O as R,P as _,L as U,z as y,az as j,u as G,aA as H}from"./vendor-CcmhhHhJ.js";import{D as P}from"./DynamicForm-DlnD6bQ4.js";import{b as Q,s as J}from"./index-C9Sfkt3t.js";import"./testResultService-DcwpN3WV.js";import"./supabase-fOlwtt9p.js";const K={style:{"margin-top":"10px","font-size":"13px",color:"#e30707"}},W={class:"dialog-footer"},X=I({__name:"ScoreDialog",props:{Score:{default:0},centerDialogVisible:{type:Boolean},incorrectAnswers:{}},emits:["update:centerDialogVisible"],setup(V,{emit:n}){const t=V,m=l(t.incorrectAnswers),r=l(t.centerDialogVisible);B(()=>{document.querySelector(".score-dialog p"),document.querySelector(".score-dialog h3"),r.value&&g(t.Score)});const g=o=>{F(()=>{const e=document.querySelector(".score-dialog p"),c=document.querySelector(".score-dialog h3");o>=100?(c.setAttribute("style","color: #67c23a"),e&&(e.setAttribute("style","color: #606266"),e.innerText="太棒了！你拿到了满分！")):(c.setAttribute("style","color: #606266"),e&&(e.setAttribute("style","color: #606266"),e.innerText="继续努力吧！"))})};D(()=>t.incorrectAnswers,o=>{m.value=o}),D(()=>t.Score,o=>{console.log(o),r.value&&g(t.Score)}),D(()=>t.centerDialogVisible,o=>{r.value=o});const S=n,f=()=>{r.value=!1,S("update:centerDialogVisible",r.value),console.log("props.centerDialogVisible:",t.centerDialogVisible,m.value)};return(o,e)=>{const c=b("el-button"),v=b("el-dialog");return y(),N(v,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),title:"你的测试成绩",width:"500","align-center":"",center:"",onClose:f,onOpen:e[1]||(e[1]=s=>g(o.Score)),class:"score-dialog"},{footer:d(()=>[u("div",W,[_(c,{type:"primary",onClick:f},{default:d(()=>e[2]||(e[2]=[U(" 确定 ")])),_:1})])]),default:d(()=>[u("h3",null,p(o.Score),1),e[3]||(e[3]=u("p",null,"Open the dialog from the center from the screen",-1)),u("ul",K,[(y(!0),C(R,null,L(m.value,s=>(y(),C("li",{style:{"list-style":"decimal"},key:s.questionId},p(s.questionIndex)+"错误，你的答案："+p(s.userAnswer)+"，正确答案："+p(s.correctAnswer),1))),128))])]),_:1},8,["modelValue"])}}}),Y=Q(X,[["__scopeId","data-v-19dc1b55"]]),Z={class:"subtitle"},ne=I({__name:"MultipleChoice",setup(V){var q,w,x,h,k;const n=l([]),t=j(),m=H(),r=l(((q=t.query.testId)==null?void 0:q.toString())||"multiple-choice-test"),g=l(((w=t.query.testName)==null?void 0:w.toString())||"未命名测试"),S=l((x=t.query.platform)==null?void 0:x.toString()),f=l((h=t.query.chapter)==null?void 0:h.toString()),o=l(((k=t.query.type)==null?void 0:k.toString())||"select"),e=()=>{m.back()},c=async()=>{const{data:i,error:a}=await J.rpc("get_limited_google_questions",{p_question_type:o.value=="case"?"reading":o.value,p_platform:S.value,p_chapter:f.value});a?z.error(`获取问题时出错:${a}, 请检查网络连接或联系管理员`):(n.value=i,console.log(n.value))};B(()=>{c()});const v=l(0),s=l(!1),A=l([]),E=async i=>{console.log("用户答案:",i.answers),v.value=i.score,A.value=i.incorrectAnswers,s.value=!0,console.log("得分:",v.value,s.value,A.value)};return(i,a)=>{const T=b("el-page-header"),M=b("el-card");return y(),N(M,{style:{"min-height":"400px","margin-top":"30px",padding:"0 20px"}},{default:d(()=>[_(T,{onBack:e,icon:G(O)},{content:d(()=>a[1]||(a[1]=[u("span",{class:"text-large font-600 mr-3"}," 选择题 ",-1)])),default:d(()=>[u("div",Z,"共"+p(n.value.length)+"道选择题，每题10分，满分"+p(n.value.length*10)+"分。",1)]),_:1},8,["icon"]),_(P,{questions:n.value,testId:r.value,testName:g.value,type:o.value,onSubmitAnswers:E},null,8,["questions","testId","testName","type"]),_(Y,{Score:v.value,centerDialogVisible:s.value,incorrectAnswers:A.value,"onUpdate:centerDialogVisible":a[0]||(a[0]=$=>s.value=$)},null,8,["Score","centerDialogVisible","incorrectAnswers"])]),_:1})}}});export{ne as default};

import{E as T,k as $}from"./elementPlus-BSeP1oVM.js";import{x as k,r as l,j as C,n as F,w as S,G as N,ag as v,H as c,A as f,y as z,J as O,M as b,P as _,L as q,z as x,ax as R,u as U,ay as W}from"./vendor-kUynFKsh.js";import{D as j}from"./DynamicForm-DmpllPZT.js";import{b as B,s as G}from"./index-BID3odBW.js";import"./testResultService-MOr0OWWT.js";import"./supabase-CBzAt1Op.js";const H={key:0,style:{"margin-top":"10px","font-size":"14px",color:"#606266"}},J={class:"dialog-footer"},L=k({__name:"ScoreDialog",props:{Score:{default:0},centerDialogVisible:{type:Boolean},incorrectAnswers:{}},emits:["update:centerDialogVisible"],setup(V,{emit:r}){const t=V,d=l(t.incorrectAnswers),s=l(t.centerDialogVisible);C(()=>{document.querySelector(".score-dialog p"),document.querySelector(".score-dialog h3"),s.value&&g(t.Score)});const g=o=>{F(()=>{const e=document.querySelector(".score-dialog p"),n=document.querySelector(".score-dialog h3");o>=100?(n.setAttribute("style","color: #67c23a"),e&&(e.setAttribute("style","color: #606266"),e.innerText="太棒了！你拿到了满分！")):(n.setAttribute("style","color: #606266"),e&&(e.setAttribute("style","color: #606266"),e.innerText="继续努力吧！"))})};S(()=>t.incorrectAnswers,o=>{d.value=o}),S(()=>t.Score,o=>{console.log(o),s.value&&g(t.Score)}),S(()=>t.centerDialogVisible,o=>{s.value=o});const w=r,i=()=>{s.value=!1,w("update:centerDialogVisible",s.value),console.log("props.centerDialogVisible:",t.centerDialogVisible,d.value)};return(o,e)=>{const n=v("el-text"),u=v("el-button"),m=v("el-dialog");return x(),N(m,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=y=>s.value=y),title:"你的测试成绩",width:"500","align-center":"",center:"",onClose:i,onOpen:e[1]||(e[1]=y=>g(o.Score)),class:"score-dialog"},{footer:c(()=>[f("div",J,[_(u,{type:"primary",onClick:i},{default:c(()=>e[3]||(e[3]=[q(" 确定 ")])),_:1})])]),default:c(()=>[f("h3",null,b(o.Score),1),e[4]||(e[4]=f("p",null,"Open the dialog from the center from the screen",-1)),d.value.length>0?(x(),z("div",H,[_(n,{type:"info"},{default:c(()=>e[2]||(e[2]=[q("错误题目已在答题区域标红显示，正确答案显示在题目下方")])),_:1})])):O("",!0)]),_:1},8,["modelValue"])}}}),P=B(L,[["__scopeId","data-v-0d1fe5cb"]]),Q={class:"subtitle"},K=k({__name:"MultipleChoice",setup(V){var D,h,A;const r=l([]),t=R(),d=W(),s=l(((D=t.query.testId)==null?void 0:D.toString())||"multiple-choice-test"),g=l(((h=t.query.testName)==null?void 0:h.toString())||"未命名测试"),w=l(((A=t.query.type)==null?void 0:A.toString())||"select"),i=l(t.query.score_weight?Number(t.query.score_weight):100),o=()=>{d.back()},e=async()=>{const{data:p,error:a}=await G.from("googlequestions").select("*").eq("tests_id",s.value);a?T.error(`获取问题时出错:${a.message}, 请检查网络连接或联系管理员`):(r.value=p||[],console.log("获取到的题目:",r.value))};C(()=>{e()});const n=l(0),u=l(!1),m=l([]),y=async p=>{console.log("用户答案:",p.answers),n.value=p.score,m.value=p.incorrectAnswers,u.value=!0,console.log("得分:",n.value,u.value,m.value)};return(p,a)=>{const I=v("el-page-header"),E=v("el-card");return x(),N(E,{style:{"min-height":"400px","margin-top":"30px",padding:"0 20px"}},{default:c(()=>[_(I,{onBack:o,icon:U($)},{content:c(()=>a[1]||(a[1]=[f("span",{class:"text-large font-600 mr-3"}," 选择题 ",-1)])),default:c(()=>[f("div",Q,"共"+b(r.value.length)+"道选择题，每题"+b(parseFloat((i.value/r.value.length).toFixed(2)))+"分，满分"+b(i.value)+"分。",1)]),_:1},8,["icon"]),_(j,{scoreWeight:i.value,questions:r.value,testId:s.value,testName:g.value,type:w.value,onSubmitAnswers:y},null,8,["scoreWeight","questions","testId","testName","type"]),_(P,{Score:n.value,centerDialogVisible:u.value,incorrectAnswers:m.value,"onUpdate:centerDialogVisible":a[0]||(a[0]=M=>u.value=M)},null,8,["Score","centerDialogVisible","incorrectAnswers"])]),_:1})}}}),se=B(K,[["__scopeId","data-v-7f333735"]]);export{se as default};

import{e as L,E as j}from"./elementPlus-DTEdDlyA.js";import{u as N,_ as R}from"./index-bQe1g-4U.js";import{x as z,r as x,j as A,G as _,H as e,P as t,ag as n,A as m,L as b,M as k,u as O,az as D,z as l,c as P,y as S,O as $,a6 as E,K as H,aE as q}from"./vendor-COQJj1AX.js";import"./supabase-Dt8ksRgS.js";const F={class:"toolbar",style:{display:"flex","justify-content":"end","align-items":"center"}},G={style:{display:"inline-block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","margin-right":"5px"}},J=z({__name:"Header",setup(C){const v=D(),g=N(),s=x(g.user);console.log(s.value,"user"),x(""),A(()=>{s.value=g.getUser()});const r=()=>{g.logout(),v.push("/login")};return(w,c)=>{const u=n("el-col"),M=n("el-avatar"),a=n("el-icon"),d=n("el-link"),i=n("el-dropdown-item"),p=n("el-dropdown-menu"),h=n("el-dropdown"),f=n("el-row"),o=n("el-header");return l(),_(o,{style:{"font-size":"16px"}},{default:e(()=>[t(f,{justify:"space-between",gutter:16,style:{height:"100%","align-items":"center"}},{default:e(()=>[t(u,{span:3},{default:e(()=>c[0]||(c[0]=[m("h1",{style:{"font-size":"40px","font-weight":"700"}},"IWISH",-1)])),_:1}),t(u,{span:4},{default:e(()=>{var y,B;return[m("div",F,[t(M,{style:{"margin-right":"10px","min-width":"40px","font-size":"20px","font-weight":"700","align-items":"center","line-height":"40px","justify-content":"center",background:"#2f87ff"},src:(y=s.value)==null?void 0:y.avatar_url},{default:e(()=>{var I,U,V;return[b(k(((V=(U=(I=s.value)==null?void 0:I.full_name)==null?void 0:U.charAt(0))==null?void 0:V.toUpperCase())||"U"),1)]}),_:1},8,["src"]),m("span",G,k((B=s.value)==null?void 0:B.full_name),1),t(h,null,{dropdown:e(()=>[t(p,null,{default:e(()=>[t(i,null,{default:e(()=>[t(d,{href:"/system/personal-data"},{default:e(()=>c[1]||(c[1]=[b(" 个人中心")])),_:1})]),_:1}),t(i,{onClick:r},{default:e(()=>c[2]||(c[2]=[b("退出登录")])),_:1})]),_:1})]),default:e(()=>[t(a,{style:{"margin-right":"10px","margin-top":"1px","font-size":"18px",color:"#fff"}},{default:e(()=>[t(O(L))]),_:1})]),_:1})])]}),_:1})]),_:1})]),_:1})}}}),K=R(J,[["__scopeId","data-v-8f6d8bf3"]]),T=z({__name:"Aside",setup(C){D();const v=x(""),g=x([]),s=x(!1),r=N(),w=P(()=>r.getMenus);A(async()=>{s.value=!0,await r.fetchMenus(),s.value=!1,console.log(w.value,"aside menus")});const c=a=>{v.value=a,a==="/system/demand"&&M()};function u(a){const d=typeof a=="string"?a:JSON.stringify(a);return btoa(d).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const M=()=>{var a,d,i,p,h;try{const f={id:((a=r.user)==null?void 0:a.user_id)||"",email:((d=r.user)==null?void 0:d.email)||"",name:((i=r.user)==null?void 0:i.full_name)||((h=(p=r.user)==null?void 0:p.email)==null?void 0:h.split("@")[0])||"用户"},o=u(f);window.open(`https://iwishneed.netlify.app/auth/bridge?external_user=${o}`,"_blank")}catch(f){console.error("处理demand跳转失败:",f),j.error("跳转失败，请稍后重试")}};return(a,d)=>{const i=n("el-icon"),p=n("el-menu-item"),h=n("el-sub-menu"),f=n("el-menu");return l(),_(f,{class:"el-menu-vertical-demo","active-text-color":"#fff","background-color":"#05479a","text-color":"#fff",style:{position:"fixed","z-index":"999",height:"calc(100vh - 84px)",left:"0",width:"240px"},router:!0,"unique-opened":!0,"default-active":v.value,"default-openeds":g.value,onSelect:c,loading:s.value},{default:e(()=>[(l(!0),S($,null,E(w.value,o=>(l(),S($,{key:o.id},[o.children&&o.children.length>0?(l(),_(h,{key:0,index:`/system${o.path}`},{title:e(()=>[t(i,null,{default:e(()=>[(l(),_(H(o.icon)))]),_:2},1024),m("span",null,k(o.name),1)]),default:e(()=>[(l(!0),S($,null,E(o.children,y=>(l(),_(p,{key:y.id,index:`/system${y.path}`},{default:e(()=>[b(k(y.name),1)]),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(l(),_(p,{key:1,index:`/system${o.path}`},{default:e(()=>[t(i,null,{default:e(()=>[(l(),_(H(o.icon)))]),_:2},1024),m("span",null,k(o.name),1)]),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active","default-openeds","loading"])}}}),W={class:"common-layout"},Q={class:"page-container"},X={class:"loading-container"},Y=z({__name:"SystemMain",setup(C){return x([]),(v,g)=>{const s=n("el-aside"),r=n("RouterView"),w=n("el-skeleton"),c=n("el-main"),u=n("el-container");return l(),S("div",W,[t(u,{direction:"vertical",style:{height:"100vh"}},{default:e(()=>[t(K),t(u,{style:{"margin-top":"84px"}},{default:e(()=>[t(s,{width:"240px"},{default:e(()=>[t(T)]),_:1}),t(u,null,{default:e(()=>[t(c,null,{default:e(()=>[m("div",Q,[(l(),_(q,null,{default:e(()=>[t(r)]),fallback:e(()=>[m("div",X,[t(w,{rows:3,animated:""})])]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),oe=R(Y,[["__scopeId","data-v-f490535e"]]);export{oe as default};

import{d as b,u as V,r as f,J as p,l as y,a as o,w as t,b as u,f as c,s as C,M as _,j as x,_ as E}from"./index-BsBxzW2u.js";const F={class:"change-password-container"},U=b({__name:"ChangePassword",setup(h){V();const a=f(),i=f(!1),s=p({currentPassword:"",newPassword:"",confirmPassword:""}),P=p({currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],newPassword:[{required:!0,validator:(n,e,r)=>{e===""?r(new Error("请输入密码")):(s.confirmPassword!==""&&a.value&&a.value.validateField("confirmPassword"),r())},trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],confirmPassword:[{required:!0,validator:(n,e,r)=>{e===""?r(new Error("请再次输入密码")):e!==s.newPassword?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}]}),g=async()=>{a.value&&await a.value.validate(async n=>{if(n){i.value=!0;try{const{error:e}=await C.auth.updateUser({password:s.newPassword});if(e)throw e;_.success("密码修改成功"),w()}catch(e){console.error("修改密码失败:",e),_.error(e.message||"修改密码失败")}finally{i.value=!1}}})},w=()=>{a.value&&a.value.resetFields()};return(n,e)=>{const r=u("el-input"),d=u("el-form-item"),m=u("el-button"),v=u("el-form");return x(),y("div",F,[o(v,{ref_key:"formRef",ref:a,model:s,rules:P,"label-width":"120px",class:"password-form"},{default:t(()=>[o(d,{label:"当前密码",prop:"currentPassword"},{default:t(()=>[o(r,{modelValue:s.currentPassword,"onUpdate:modelValue":e[0]||(e[0]=l=>s.currentPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"新密码",prop:"newPassword"},{default:t(()=>[o(r,{modelValue:s.newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>s.newPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"确认新密码",prop:"confirmPassword"},{default:t(()=>[o(r,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>s.confirmPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[o(m,{type:"primary",onClick:g,loading:i.value},{default:t(()=>e[3]||(e[3]=[c("确认修改")])),_:1},8,["loading"]),o(m,{onClick:w},{default:t(()=>e[4]||(e[4]=[c("重置")])),_:1})]),_:1})]),_:1},8,["model","rules"])])}}}),M=E(U,[["__scopeId","data-v-259c421f"]]);export{M as default};

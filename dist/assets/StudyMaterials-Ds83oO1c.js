import{_ as L,a as O,b as W,c as R,d as H,e as J,f as K,g as Z,h as A,i as G,j as Q,k as X,l as Y}from"./zip-KiBfUjci.js";import{d as ee,r as i,H as te,J as ae,o as se,l as b,a as n,y as le,w as r,b as s,O as oe,c as f,P as ne,s as w,M as ce,F as k,m as z,f as ie,q as re,j as _,e as S,t as _e,_ as pe}from"./index-w0Vcq8R-.js";const ue={class:"study"},de=["onClick"],ge={class:"study-content-title hide-text-2"},ve=ee({__name:"StudyMaterials",setup(me){const v=i([]),p=i(!1),u=i(""),d=i(""),V=i("desc"),y=te(),C=i(y.query.platform||"google"),P=i(y.query.chapter||"base"),c=ae({page:1,pageSize:10,total:0}),q=t=>{c.page=t.page,c.pageSize=t.pageSize,m()},m=async()=>{try{p.value=!0;let t=w.from("study_materials").select("*",{count:"exact"}).eq("platform",C.value).eq("chapter",P.value);u.value&&(t=t.ilike("title",`%${u.value}%`)),d.value&&(t=t.eq("type",d.value));const{data:e,error:o,count:g}=await t.order("created_at",{ascending:V.value==="asc"}).range((c.page-1)*c.pageSize,c.page*c.pageSize-1);if(o)throw o;v.value=e,c.total=g!==null?g:0}catch(t){ce.error(`数据加载失败: ${t}`)}finally{p.value=!1}},D=async t=>{try{const{data:e,error:o}=await w.from("material_contents").select("*").in("material_id",[t]);if(o)throw o;console.log(e[0].content),window.open(e[0].content,"_blank")}catch(e){return console.error("查询失败:",e),null}};se(()=>{m()});const M=t=>{const e=x.find(o=>o.icon===t);return e?e.src:x[0].src},U=[{value:"image",label:"图片"},{value:"video",label:"视频"},{value:"txt",label:"文本"},{value:"pdf",label:"PDF"},{value:"ppt",label:"PPT"},{value:"link",label:"链接"},{value:"word",label:"Word"},{value:"excel",label:"Excel"},{value:"zip",label:"压缩包"}],l=t=>new URL(Object.assign({"/src/assets/icons/excel.png":Y,"/src/assets/icons/file.png":X,"/src/assets/icons/image.png":Q,"/src/assets/icons/link.png":G,"/src/assets/icons/music.png":A,"/src/assets/icons/pdf.png":Z,"/src/assets/icons/ppt.png":K,"/src/assets/icons/reading.png":J,"/src/assets/icons/select.png":H,"/src/assets/icons/txt.png":R,"/src/assets/icons/video.png":W,"/src/assets/icons/word.png":O,"/src/assets/icons/zip.png":L})[`/src/assets/icons/${t}.png`],import.meta.url).href,x=[{icon:"image",label:"图片",src:l("image")},{icon:"pdf",label:"PDF",src:l("pdf")},{icon:"word",label:"Word 文档",src:l("word")},{icon:"excel",label:"Excel 表格",src:l("excel")},{icon:"txt",label:"文本文件",src:l("txt")},{icon:"link",label:"链接",src:l("link")},{icon:"video",label:"视频",src:l("video")},{icon:"zip",label:"ZIP 压缩文件",src:l("zip")},{icon:"ppt",label:"PPT 演示文稿",src:l("ppt")}];return(t,e)=>{const o=s("el-option"),g=s("el-select"),$=s("el-input"),B=s("el-button"),E=s("el-space"),h=s("el-card"),F=s("el-image"),I=s("el-col"),N=s("el-row"),T=s("el-empty"),j=oe("loading");return _(),b("div",ue,[n(h,{class:"study-search",style:{"margin-bottom":"20px"}},{default:r(()=>[n(E,{alignment:"start",size:30},{default:r(()=>[n(g,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),placeholder:"选择文件类型",clearable:"",size:"large",style:{width:"240px"}},{default:r(()=>[(_(),b(k,null,z(U,a=>n(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),n($,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),clearable:"",style:{width:"240px"},placeholder:"请输入文件标题","suffix-icon":"Search",size:"large"},null,8,["modelValue"]),n(B,{type:"primary",size:"large",onClick:e[2]||(e[2]=a=>m())},{default:r(()=>e[3]||(e[3]=[ie("搜索")])),_:1})]),_:1})]),_:1}),le((_(),f(h,{style:{"min-height":"400px"}},{default:r(()=>[n(N,{gutter:40,style:{"row-gap":"30px"}},{default:r(()=>[(_(!0),b(k,null,z(v.value,(a,be)=>(_(),f(I,{xs:12,sm:8,md:6,lg:4},{default:r(()=>[S("div",{class:"grid-content-column",onClick:fe=>D(a.id)},[n(F,{style:{width:"120px",height:"120px"},src:M(a.type),fit:"fill"},null,8,["src"]),S("div",ge,_e(a.title),1)],8,de)]),_:2},1024))),256))]),_:1}),!p.value&&v.value.length===0?(_(),f(T,{key:0,description:"暂无数据"})):re("",!0)]),_:1})),[[j,p.value]]),n(ne,{pagination:c,onUpdate:q},null,8,["pagination"])])}}}),he=pe(ve,[["__scopeId","data-v-bc788dcb"]]);export{he as default};

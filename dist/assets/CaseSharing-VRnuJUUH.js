import{E as D,s as mt,N as ue,u as de,P as Ae,C as Be,Q as pt,O as _t,R as vt,S as ft,B as gt,o as ht,c as Fe}from"./elementPlus-COdCHMXA.js";import{s as x,u as yt,B as wt,e as bt,b as kt}from"./index-CxnpMWLP.js";import{W as qe}from"./WordDocumentViewer-CCR0F_7w.js";import{x as Ct,X as ce,c as J,r as c,j as Vt,y as _,P as t,A as o,H as s,ag as v,G as k,J as f,u as g,O as Ee,a6 as Ne,L as m,I as xt,aq as Dt,M as h,z as i}from"./vendor-kUynFKsh.js";import"./supabase-Bu12BySZ.js";import"./index-B0r6nX_L.js";const zt=r=>r===0||r===1||r===11,X={async getAllCases(r={}){let u=x.from("case_sharing").select("*",{count:"exact"});if(r.query&&(u=u.or(`title.ilike.%${r.query}%,custom_sharer.ilike.%${r.query}%,custom_department.ilike.%${r.query}%`)),r.category&&r.category!=="all"&&(u=u.eq("category",r.category)),r.startDate&&r.endDate&&(u=u.gte("created_at",r.startDate).lte("created_at",r.endDate)),r.viewType==="my"){const{data:{user:E}}=await x.auth.getUser();E&&(u=u.eq("created_by",E.id))}r.showStatus!==void 0?u=u.eq("is_show",r.showStatus==="true"):u=u.eq("is_show",!0);const y=((r.page||1)-1)*(r.pageSize||10),C=y+(r.pageSize||10)-1,{data:b,error:V,count:j}=await u.order("created_at",{ascending:!1}).range(y,C);if(V)throw V;return{data:b,total:j||0}},async getCase(r){const{data:u,error:y}=await x.from("case_sharing").select("*").eq("id",r).single();if(y)throw y;return u},async createCase(r){const{data:{user:u}}=await x.auth.getUser();if(!u)throw new Error("User not authenticated");const{data:y,error:C}=await x.from("user_profiles").select("full_name, organization_id").eq("user_id",u.id).single();if(C)throw C;const{data:b,error:V}=await x.from("case_sharing").insert({...r,created_by:u.id,created_by_name:y.full_name||u.email,organization_id:y.organization_id}).select().single();if(V)throw V;return b},async updateCase(r,u){const{data:y,error:C}=await x.from("case_sharing").update(u).eq("id",r).select().single();if(C)throw C;return y},async deleteCase(r){const{error:u}=await x.from("case_sharing").delete().eq("id",r);if(u)throw u},async uploadFile(r,u){const y=`${new Date().getTime()}_${r.name}`,C=`${u}/${y}`,{data:b,error:V}=await x.storage.from("materials").upload(C,r);if(V)throw V;const{data:{publicUrl:j}}=x.storage.from("materials").getPublicUrl(C);return{url:j,filename:y}}},Ut={class:"layout"},St={class:"layout-title"},$t={class:"status-tabs"},Tt={class:"cases-content"},At={class:"card-header"},Bt={class:"header-actions"},Ft={style:{"font-size":"14px",color:"#909399"}},qt={class:"month-info"},Et={key:0,class:"month-item"},Nt={class:"month-text"},Mt={key:1,class:"month-empty"},Lt={class:"sharer-dept-info"},Pt={key:0,class:"sharer-item"},Yt={class:"sharer-text"},jt={key:1,class:"dept-item"},Ot={class:"dept-text"},Wt={key:2,class:"sharer-dept-empty"},Ht={key:2},Rt={class:"dialog-content"},Gt={class:"case-details"},Qt={class:"case-header"},Jt={class:"case-title"},Xt={class:"case-meta"},Kt={class:"meta-item"},Zt={class:"meta-item"},It={class:"meta-item"},el={class:"case-section"},tl=["innerHTML"],ll={key:0,class:"case-section"},al={class:"attachment-box"},sl={class:"attachment-name"},ol={key:1,class:"case-section"},nl={class:"link-box"},il={class:"link-url"},rl={key:2,class:"case-section"},ul={class:"custom-info"},dl={key:0,class:"custom-item"},cl={class:"custom-value"},ml={key:1,class:"custom-item"},pl={class:"custom-value"},_l={key:2,class:"custom-item"},vl={class:"custom-value"},fl={class:"dialog-footer"},gl={class:"attachment-preview"},hl=["src"],yl=["src"],wl={key:3,class:"attachment-download"},bl={class:"dialog-footer"},kl={class:"fullscreen-preview"},Cl=["src"],Vl=["src"],xl={class:"share-disk-dialog"},Dl={class:"disk-options"},zl={class:"button-content"},Ul={class:"button-content"},Sl={class:"dialog-footer"},$l={class:"dialog-footer"},Tl=Ct({__name:"CaseSharing",setup(r){const u=ce([{name:"分享分享",path:"/system/case-sharing"}]),y=yt(),C=J(()=>{var l;return((l=y.user)==null?void 0:l.user_id)||""}),b=J(()=>zt(Number(y.roleId))),V=c(!1),j=c([]),E=c(!1),O=c(!1),d=c(null),ae=c(""),B=c([]),K=c(""),Z=c(!1),I=c("all"),N=c([]),se=c(),M=c(!1),ee=c(""),W=c(!1),z=c(""),te=c(""),$=c(""),oe=c(!1),H=c(!1),me=l=>{let e="";l==="ugospro"?e="https://192-168-1-37.iwish.direct.ug.link:9443/desktop/?os=ugospro#/login/account":l==="iwish"&&(e="https://iwish.cn57.ug.link/invite/?code%3D549A366803426187%26LANG%3Dzh-CN"),e&&(window.open(e,"_blank"),H.value=!1)},n=ce({id:"",title:"",content:"",category:"",is_show:!0,attachment_url:"",attachment_name:"",attachment_type:"",link_url:"",custom_month:"",custom_sharer:"",custom_department:""}),Me={title:[{required:!0,message:"请输入分享标题",trigger:"blur"},{min:2,max:100,message:"标题长度应在2到100个字符之间",trigger:"blur"}],category:[{required:!0,message:"请选择分享类型",trigger:"change"}],content:[{required:!1,message:"请输入分享内容",trigger:"blur"},{min:2,max:1e4,message:"内容长度应在8到10000个字符之间",trigger:"blur"}]},pe=[{label:"广告",value:"advertising"},{label:"素材",value:"material"},{label:"日常运营",value:"daily_operation"},{label:"客户案例",value:"customer_case"},{label:"技术分享",value:"technical"},{label:"其他",value:"other"}],F=ce({page:1,pageSize:10,total:0}),le=c([]),T=c(null),Le=[{text:"最近一周",value:()=>{const l=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,l]}},{text:"最近一个月",value:()=>{const l=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,l]}},{text:"最近三个月",value:()=>{const l=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,l]}}],ne=J(()=>$.value?$.value.startsWith("image/"):!1),ie=J(()=>$.value?$.value==="application/pdf":!1),re=J(()=>$.value?$.value==="application/msword"||$.value==="application/vnd.openxmlformats-officedocument.wordprocessingml.document":!1),Pe=l=>{switch(l){case"advertising":return"primary";case"material":return"success";case"daily_operation":return"warning";case"customer_case":return"danger";case"technical":return"info";case"other":return"";default:return"info"}},_e=l=>{switch(l){case"advertising":return"广告";case"material":return"素材";case"daily_operation":return"日常运营";case"customer_case":return"客户分享";case"technical":return"技术分享";case"other":return"其他";default:return l||"未知"}},Ye=l=>b.value?!0:l.created_by===C.value,je=l=>b.value?!0:l.created_by===C.value,Oe=l=>{F.page=l.page,F.pageSize=l.pageSize,L()},L=async()=>{V.value=!0;const l=B.value!=null&&B.value[0]!=null?B.value[0].toDateString():"",e=B.value!=null&&B.value[1]!=null?B.value[1].toDateString():"";try{const U=await X.getAllCases({query:ae.value,startDate:l,endDate:e,page:F.page,pageSize:F.pageSize,category:ee.value!==""?ee.value:void 0,showStatus:b.value&&K.value!==""?K.value:void 0,viewType:I.value});j.value=U.data,F.total=U.total}catch(U){D.error("搜索分享失败"),console.error("搜索分享失败:",U)}finally{V.value=!1}},We=async l=>{E.value=!0,d.value=l},He=l=>{l.attachment_url&&(z.value=l.attachment_url,te.value=l.title,$.value=ge(l.attachment_name),W.value=!0)},Re=()=>{var l;(l=d.value)!=null&&l.attachment_url&&(z.value=d.value.attachment_url,te.value=d.value.title,$.value=ge(d.value.attachment_name),W.value=!0)},Ge=()=>{z.value&&window.open(z.value,"_blank")},ve=()=>{oe.value=!0},fe=l=>{l&&window.open(l,"_blank")},ge=l=>{if(!l)return"";const e=Qe(l);return["jpg","jpeg","png","gif","webp"].includes(e)?"image/"+e:e==="pdf"?"application/pdf":["doc","dot"].includes(e)?"application/msword":["docx"].includes(e)?"application/vnd.openxmlformats-officedocument.wordprocessingml.document":""},Qe=l=>{if(!l)return"";const e=l.split(".");return e.length>1?e[e.length-1].toLowerCase():""},Je=()=>{M.value=!1,O.value=!0,Object.assign(n,{id:"",title:"",content:"",category:"",is_show:!0,attachment_url:"",attachment_name:"",attachment_type:"",link_url:"",custom_month:"",custom_sharer:"",custom_department:""}),le.value=[],T.value=null},Xe=l=>{M.value=!0,O.value=!0,Object.assign(n,{id:l.id,title:l.title,content:l.content,category:l.category,is_show:l.is_show,attachment_url:l.attachment_url,attachment_name:l.attachment_name,attachment_type:l.attachment_type,link_url:l.link_url,custom_month:l.custom_month,custom_sharer:l.custom_sharer,custom_department:l.custom_department}),le.value=[],T.value=null},Ke=l=>{N.value=l},Ze=l=>{const e=["application/pdf","application/msword","text/plain","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/png","image/gif","image/webp"],U=l.raw&&e.includes(l.raw.type),R=l.raw&&l.raw.size/1024/1024<10;if(!U)return D.error("文件类型不支持！"),!1;if(!R)return D.error("文件大小超过 10MB 限制！"),!1;T.value=l.raw,console.log("Selected file:",T.value)},Ie=async l=>{if(!l)throw new Error("No file selected");const e=l.name.split(".").pop(),R=`casesharing/${`${Date.now()}-${Math.random().toString(36).substring(2)}.${e}`}`,{data:q,error:P}=await x.storage.from("materials").upload(R,l);if(P)throw P;const{data:G}=x.storage.from("materials").getPublicUrl(q.path);return G.publicUrl},et=async()=>{se.value&&await se.value.validate(async l=>{if(l){Z.value=!0;try{if(T.value)try{const e=await Ie(T.value);n.attachment_url=e,n.attachment_name=T.value.name,n.attachment_type=T.value.type}catch(e){D.error(`文件上传失败: ${e.message||"未知错误"}`),Z.value=!1;return}M.value?(await X.updateCase(n.id,{title:n.title,content:n.content,category:n.category,is_show:n.is_show,attachment_url:n.attachment_url,attachment_name:n.attachment_name,attachment_type:n.attachment_type,link_url:n.link_url,custom_month:n.custom_month,custom_sharer:n.custom_sharer,custom_department:n.custom_department}),D.success("分享已更新")):(await X.createCase({title:n.title,content:n.content,category:n.category,is_show:n.is_show,attachment_url:n.attachment_url,attachment_name:n.attachment_name,attachment_type:n.attachment_type,link_url:n.link_url,custom_month:n.custom_month,custom_sharer:n.custom_sharer,custom_department:n.custom_department}),D.success("分享已创建")),O.value=!1,L(),le.value=[],T.value=null}catch(e){D.error(M.value?"更新分享失败":"创建分享失败"),console.error(M.value?"更新分享失败:":"创建分享失败:",e)}finally{Z.value=!1}}})},tt=async l=>{try{await Fe.confirm(`确定要删除 "${l.title}" 这个分享吗？`,"提示",{type:"warning"}),await X.deleteCase(l.id),D.success("删除成功"),L()}catch(e){e!=="cancel"&&(D.error("删除失败"),console.error("删除失败:",e))}},lt=async()=>{if(N.value.length!==0)try{await Fe.confirm(`确定要删除选中的 ${N.value.length} 个分享吗？此操作不可恢复。`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const l=N.value.map(e=>X.deleteCase(e.id));await Promise.all(l),D.success(`成功删除 ${N.value.length} 个分享`),N.value=[],L()}catch(l){l!=="cancel"&&(console.error("批量删除分享失败:",l),D.error("批量删除失败"))}},at=()=>{H.value=!0},st=l=>{I.value=l,F.page=1,L()};return Vt(()=>{L()}),(l,e)=>{const U=v("el-tab-pane"),R=v("el-tabs"),q=v("el-input"),P=v("el-option"),G=v("el-select"),he=v("el-date-picker"),p=v("el-button"),ot=v("el-space"),ye=v("el-card"),S=v("el-table-column"),w=v("el-icon"),we=v("el-tag"),nt=v("el-button-group"),it=v("el-empty"),rt=v("el-table"),Q=v("el-dialog"),A=v("el-form-item"),ut=v("el-upload"),dt=v("el-switch"),ct=Dt("loading");return i(),_("div",Ut,[t(wt,{breadcrumb:u},null,8,["breadcrumb"]),o("div",St,[e[25]||(e[25]=o("h1",{class:"title"},"知识分享",-1)),o("div",$t,[t(R,{class:"demo-tabs",modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),onTabChange:st},{default:s(()=>[t(U,{name:"all",label:"全部分享"}),t(U,{name:"my",label:"我的分享"})]),_:1},8,["modelValue"])])]),t(ye,{shadow:"always",style:{"margin-bottom":"20px"}},{default:s(()=>[t(ot,{wrap:"",alignment:"start",size:30},{default:s(()=>[t(q,{modelValue:ae.value,"onUpdate:modelValue":e[1]||(e[1]=a=>ae.value=a),style:{width:"400px"},placeholder:"搜索标题、分享人、部门（支持模糊搜索）","suffix-icon":g(mt),size:"large",clearable:""},null,8,["modelValue","suffix-icon"]),t(G,{modelValue:ee.value,"onUpdate:modelValue":e[2]||(e[2]=a=>ee.value=a),placeholder:"分享类型",clearable:"",style:{width:"180px"},size:"large"},{default:s(()=>[(i(),_(Ee,null,Ne(pe,a=>t(P,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(he,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=a=>B.value=a),type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:Le,size:"large"},null,8,["modelValue"]),b.value?(i(),k(G,{key:0,modelValue:K.value,"onUpdate:modelValue":e[4]||(e[4]=a=>K.value=a),placeholder:"选择展示状态",style:{width:"160px"},size:"large",clearable:""},{default:s(()=>[t(P,{label:"显示",value:"true"}),t(P,{label:"隐藏",value:"false"})]),_:1},8,["modelValue"])):f("",!0),t(p,{type:"primary",size:"large",onClick:L},{default:s(()=>e[26]||(e[26]=[m("搜索")])),_:1}),t(p,{type:"success",size:"large",onClick:Je},{default:s(()=>e[27]||(e[27]=[m("添加分享")])),_:1})]),_:1})]),_:1}),o("div",Tt,[t(ye,{style:{"min-height":"400px"}},{header:s(()=>[o("div",At,[e[30]||(e[30]=m(" 分享列表 ")),o("div",Bt,[t(p,{type:"success",onClick:at},{default:s(()=>e[28]||(e[28]=[m(" 进入共享盘 ")])),_:1}),b.value?(i(),k(p,{key:0,type:"danger",disabled:!N.value.length,onClick:lt},{default:s(()=>e[29]||(e[29]=[m(" 批量删除 ")])),_:1},8,["disabled"])):f("",!0),o("div",Ft,"共计"+h(F.total)+"条数据",1)])])]),default:s(()=>[xt((i(),k(rt,{data:j.value,onSelectionChange:Ke,"scrollbar-always-on":!0,style:{width:"100%"}},{default:s(()=>[b.value?(i(),k(S,{key:0,type:"selection",width:"55",fixed:"left"})):f("",!0),t(S,{label:"分享月份",width:"120"},{default:s(({row:a})=>[o("div",qt,[a.custom_month?(i(),_("div",Et,[t(w,{color:"#E6A23C",size:"14"},{default:s(()=>[t(g(ue))]),_:1}),o("span",Nt,h(a.custom_month),1)])):(i(),_("div",Mt,e[31]||(e[31]=[o("span",{class:"empty-text"},"-",-1)])))])]),_:1}),t(S,{prop:"title",label:"标题","min-width":"200"}),t(S,{label:"分享人/部门","min-width":"150"},{default:s(({row:a})=>[o("div",Lt,[a.custom_sharer?(i(),_("div",Pt,[t(w,{color:"#67C23A",size:"14"},{default:s(()=>[t(g(de))]),_:1}),o("span",Yt,h(a.custom_sharer),1)])):f("",!0),a.custom_department?(i(),_("div",jt,[t(w,{color:"#F56C6C",size:"14"},{default:s(()=>[t(g(Ae))]),_:1}),o("span",Ot,h(a.custom_department),1)])):f("",!0),!a.custom_sharer&&!a.custom_department?(i(),_("div",Wt,e[32]||(e[32]=[o("span",{class:"empty-text"},"-",-1)]))):f("",!0)])]),_:1}),t(S,{prop:"category",label:"类型",width:"100"},{default:s(({row:a})=>[t(we,{type:Pe(a.category),size:"large"},{default:s(()=>[m(h(_e(a.category)),1)]),_:2},1032,["type"])]),_:1}),t(S,{label:"附件/链接",width:"100"},{default:s(({row:a})=>[a.attachment_url?(i(),k(p,{key:0,type:"primary",link:"",onClick:Y=>He(a)},{default:s(()=>[t(w,{color:"#409EFF",size:"18"},{default:s(()=>[t(g(Be))]),_:1})]),_:2},1032,["onClick"])):a.link_url?(i(),k(p,{key:1,type:"primary",link:"",onClick:Y=>fe(a.link_url)},{default:s(()=>[t(w,{color:"#67C23A",size:"18"},{default:s(()=>[t(g(pt))]),_:1})]),_:2},1032,["onClick"])):(i(),_("span",Ht,"-"))]),_:1}),b.value?(i(),k(S,{key:1,prop:"is_show",label:"展示状态",width:"80"},{default:s(({row:a})=>[t(we,{type:a.is_show?"success":"danger",size:"large"},{default:s(()=>[m(h(a.is_show?"显示":"隐藏"),1)]),_:2},1032,["type"])]),_:1})):f("",!0),t(S,{prop:"created_at",label:"创建时间",width:"150"},{default:s(({row:a})=>[m(h(new Date(a.created_at).toLocaleString()),1)]),_:1}),b.value?(i(),k(S,{key:2,prop:"created_by_name",label:"创建人",width:"80"})):f("",!0),t(S,{label:"操作",width:"230",fixed:"right"},{default:s(({row:a})=>[t(nt,null,{default:s(()=>[t(p,{type:"primary",onClick:Y=>We(a)},{default:s(()=>e[33]||(e[33]=[m("查看")])),_:2},1032,["onClick"]),Ye(a)?(i(),k(p,{key:0,type:"warning",onClick:Y=>Xe(a)},{default:s(()=>e[34]||(e[34]=[m("编辑")])),_:2},1032,["onClick"])):f("",!0),je(a)?(i(),k(p,{key:1,type:"danger",onClick:Y=>tt(a)},{default:s(()=>e[35]||(e[35]=[m("删除")])),_:2},1032,["onClick"])):f("",!0)]),_:2},1024)]),_:1}),t(it,null,{description:s(()=>e[36]||(e[36]=[m(" 暂无分享数据 ")])),_:1})]),_:1},8,["data"])),[[ct,V.value]])]),_:1}),t(bt,{pagination:F,"onUpdate:pagination":Oe},null,8,["pagination"]),t(Q,{title:"分享详情",modelValue:E.value,"onUpdate:modelValue":e[7]||(e[7]=a=>E.value=a),width:"60%","close-on-click-modal":!1,top:"5vh",class:"case-detail-dialog"},{footer:s(()=>[o("span",fl,[t(p,{onClick:e[6]||(e[6]=a=>E.value=!1)},{default:s(()=>e[47]||(e[47]=[m("关闭")])),_:1})])]),default:s(()=>{var a,Y,be,ke,Ce,Ve,xe,De,ze,Ue,Se,$e,Te;return[o("div",Rt,[o("div",Gt,[o("div",Qt,[o("h2",Jt,h(((a=d.value)==null?void 0:a.title)||"无标题"),1),o("div",Xt,[o("span",Kt,[t(w,null,{default:s(()=>[t(g(de))]),_:1}),o("span",null,h(((Y=d.value)==null?void 0:Y.created_by_name)||"未知用户"),1)]),o("span",Zt,[t(w,null,{default:s(()=>[t(g(ue))]),_:1}),o("span",null,h(d.value?new Date((be=d.value)==null?void 0:be.created_at).toLocaleString():"未知时间"),1)]),o("span",It,[t(w,null,{default:s(()=>[t(g(_t))]),_:1}),o("span",null,h(_e(((ke=d.value)==null?void 0:ke.category)||"")),1)])])]),o("div",el,[e[37]||(e[37]=o("div",{class:"section-title"},"内容",-1)),o("div",{class:"case-content",style:{padding:"10px"},innerHTML:((Ce=d.value)==null?void 0:Ce.content)||"无内容"},null,8,tl)]),(Ve=d.value)!=null&&Ve.attachment_url?(i(),_("div",ll,[e[39]||(e[39]=o("div",{class:"section-title"},"附件",-1)),o("div",al,[t(w,{color:"#409EFF",size:"16"},{default:s(()=>[t(g(Be))]),_:1}),o("span",sl,h(d.value.attachment_name),1),t(p,{type:"primary",size:"small",onClick:Re},{default:s(()=>e[38]||(e[38]=[m("查看附件")])),_:1})])])):f("",!0),(xe=d.value)!=null&&xe.link_url?(i(),_("div",ol,[e[42]||(e[42]=o("div",{class:"section-title"},"相关链接",-1)),o("div",nl,[t(w,{color:"#67C23A",size:"16"},{default:s(()=>e[40]||(e[40]=[o("link",null,null,-1)])),_:1}),o("span",il,h(d.value.link_url),1),t(p,{type:"success",size:"small",onClick:e[5]||(e[5]=Al=>fe(d.value.link_url))},{default:s(()=>e[41]||(e[41]=[m("打开链接")])),_:1})])])):f("",!0),(De=d.value)!=null&&De.custom_month||(ze=d.value)!=null&&ze.custom_sharer||(Ue=d.value)!=null&&Ue.custom_department?(i(),_("div",rl,[e[46]||(e[46]=o("div",{class:"section-title"},"分享信息",-1)),o("div",ul,[(Se=d.value)!=null&&Se.custom_month?(i(),_("div",dl,[t(w,{color:"#E6A23C",size:"16"},{default:s(()=>[t(g(ue))]),_:1}),e[43]||(e[43]=o("span",{class:"custom-label"},"月份：",-1)),o("span",cl,h(d.value.custom_month),1)])):f("",!0),($e=d.value)!=null&&$e.custom_sharer?(i(),_("div",ml,[t(w,{color:"#67C23A",size:"16"},{default:s(()=>[t(g(de))]),_:1}),e[44]||(e[44]=o("span",{class:"custom-label"},"分享人：",-1)),o("span",pl,h(d.value.custom_sharer),1)])):f("",!0),(Te=d.value)!=null&&Te.custom_department?(i(),_("div",_l,[t(w,{color:"#F56C6C",size:"16"},{default:s(()=>[t(g(Ae))]),_:1}),e[45]||(e[45]=o("span",{class:"custom-label"},"部门：",-1)),o("span",vl,h(d.value.custom_department),1)])):f("",!0)])])):f("",!0)])])]}),_:1},8,["modelValue"]),t(Q,{modelValue:W.value,"onUpdate:modelValue":e[9]||(e[9]=a=>W.value=a),title:"附件预览",width:"80%","destroy-on-close":""},{footer:s(()=>[o("span",bl,[t(p,{onClick:e[8]||(e[8]=a=>W.value=!1)},{default:s(()=>e[50]||(e[50]=[m("关闭")])),_:1}),ne.value||ie.value||re.value?(i(),k(p,{key:0,type:"primary",onClick:ve},{default:s(()=>e[51]||(e[51]=[m(" 全屏查看 ")])),_:1})):f("",!0)])]),default:s(()=>[o("div",gl,[ne.value?(i(),_("img",{key:0,src:z.value,class:"attachment-image",onClick:ve},null,8,hl)):ie.value?(i(),_("iframe",{key:1,src:z.value,class:"attachment-frame"},null,8,yl)):re.value?(i(),k(qe,{key:2,title:te.value,showBackButton:!1,showDownloadButton:!1,documentUrl:z.value},null,8,["title","documentUrl"])):(i(),_("div",wl,[e[49]||(e[49]=o("p",null,"无法预览此类型的文件，请下载后查看",-1)),t(p,{type:"primary",onClick:Ge},{default:s(()=>e[48]||(e[48]=[m("下载附件")])),_:1})]))])]),_:1},8,["modelValue"]),t(Q,{modelValue:oe.value,"onUpdate:modelValue":e[10]||(e[10]=a=>oe.value=a),title:"全屏预览",width:"100%",top:"0","show-close":!0,"destroy-on-close":"",class:"fullscreen-dialog"},{default:s(()=>[o("div",kl,[ne.value?(i(),_("img",{key:0,src:z.value,class:"fullscreen-image"},null,8,Cl)):re.value?(i(),k(qe,{key:1,title:te.value,showBackButton:!1,showDownloadButton:!1,documentUrl:z.value},null,8,["title","documentUrl"])):ie.value?(i(),_("iframe",{key:2,src:z.value,class:"fullscreen-frame"},null,8,Vl)):f("",!0)])]),_:1},8,["modelValue"]),t(Q,{modelValue:H.value,"onUpdate:modelValue":e[14]||(e[14]=a=>H.value=a),title:"登录&注册共享盘",width:"400px",center:""},{footer:s(()=>[o("span",Sl,[t(p,{onClick:e[13]||(e[13]=a=>H.value=!1)},{default:s(()=>e[54]||(e[54]=[m("取消")])),_:1})])]),default:s(()=>[o("div",xl,[o("div",Dl,[t(p,{type:"primary",size:"large",class:"disk-button",onClick:e[11]||(e[11]=a=>me("ugospro"))},{default:s(()=>[o("div",zl,[t(w,{size:"24"},{default:s(()=>[t(g(vt))]),_:1}),e[52]||(e[52]=o("span",null,"登录共享盘",-1))])]),_:1}),t(p,{type:"success",size:"large",class:"disk-button",onClick:e[12]||(e[12]=a=>me("iwish"))},{default:s(()=>[o("div",Ul,[t(w,{size:"24"},{default:s(()=>[t(g(ft))]),_:1}),e[53]||(e[53]=o("span",null,"注册共享盘账号",-1))])]),_:1})])])]),_:1},8,["modelValue"]),t(Q,{title:M.value?"编辑分享":"知识分享",modelValue:O.value,"onUpdate:modelValue":e[24]||(e[24]=a=>O.value=a),width:"50%","close-on-click-modal":!1},{footer:s(()=>[o("span",$l,[t(p,{onClick:e[23]||(e[23]=a=>O.value=!1)},{default:s(()=>e[57]||(e[57]=[m("取消")])),_:1}),t(p,{type:"primary",onClick:et,loading:Z.value},{default:s(()=>[m(h(M.value?"更新":"创建"),1)]),_:1},8,["loading"])])]),default:s(()=>[t(g(gt),{model:n,rules:Me,ref_key:"caseForm",ref:se,"label-width":"80px",style:{"max-width":"800px"}},{default:s(()=>[t(A,{label:"标题",prop:"title"},{default:s(()=>[t(q,{modelValue:n.title,"onUpdate:modelValue":e[15]||(e[15]=a=>n.title=a),placeholder:"请输入分享标题"},null,8,["modelValue"])]),_:1}),t(A,{label:"类型",prop:"category"},{default:s(()=>[t(G,{modelValue:n.category,"onUpdate:modelValue":e[16]||(e[16]=a=>n.category=a),placeholder:"选择分享类型",style:{width:"100%"}},{default:s(()=>[(i(),_(Ee,null,Ne(pe,a=>t(P,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(A,{label:"内容",prop:"content"},{default:s(()=>[t(q,{type:"textarea",modelValue:n.content,"onUpdate:modelValue":e[17]||(e[17]=a=>n.content=a),rows:10,placeholder:"请输入分享内容"},null,8,["modelValue"])]),_:1}),t(A,{label:"附件"},{default:s(()=>[t(ut,{class:"upload-box","auto-upload":!1,"on-change":Ze,"file-list":le.value,limit:1,drag:"",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",multiple:""},{tip:s(()=>e[55]||(e[55]=[o("div",{class:"el-upload__tip"}," 支持 .pdf, .doc, .docx, .xls, .xlsx, 图片等格式文件，不超过10MB ",-1)])),default:s(()=>[t(w,{class:"el-icon--upload"},{default:s(()=>[t(g(ht))]),_:1}),e[56]||(e[56]=o("div",{class:"el-upload__text"},[m(" 拖拽文件或"),o("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1}),t(A,{label:"链接"},{default:s(()=>[t(q,{modelValue:n.link_url,"onUpdate:modelValue":e[18]||(e[18]=a=>n.link_url=a),placeholder:"请输入相关链接（可选）"},null,8,["modelValue"])]),_:1}),t(A,{label:"分享月份"},{default:s(()=>[t(he,{modelValue:n.custom_month,"onUpdate:modelValue":e[19]||(e[19]=a=>n.custom_month=a),type:"month",placeholder:"选择月份（可选）",format:"YYYY年MM月","value-format":"YYYY年MM月",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(A,{label:"分享人"},{default:s(()=>[t(q,{modelValue:n.custom_sharer,"onUpdate:modelValue":e[20]||(e[20]=a=>n.custom_sharer=a),placeholder:"请输入自定义分享人（可选）"},null,8,["modelValue"])]),_:1}),t(A,{label:"分享部门"},{default:s(()=>[t(q,{modelValue:n.custom_department,"onUpdate:modelValue":e[21]||(e[21]=a=>n.custom_department=a),placeholder:"请输入分享部门（可选）"},null,8,["modelValue"])]),_:1}),b.value?(i(),k(A,{key:0,label:"状态"},{default:s(()=>[t(dt,{modelValue:n.is_show,"onUpdate:modelValue":e[22]||(e[22]=a=>n.is_show=a),"active-text":"显示","inactive-text":"隐藏"},null,8,["modelValue"])]),_:1})):f("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])])}}}),Ll=kt(Tl,[["__scopeId","data-v-267f94f2"]]);export{Ll as default};

import{u as b,s as y,b as V}from"./index-BKDCXq68.js";import{E as p}from"./elementPlus-7n3J9xVR.js";import{x,r as f,X as c,y as C,P as o,H as t,ag as u,L as P,z as E}from"./vendor-kUynFKsh.js";import"./supabase-Dk90AXsH.js";const h={class:"change-password-container"},F=x({__name:"ChangePassword",setup(U){b();const a=f(),i=f(!1),r=c({currentPassword:"",newPassword:"",confirmPassword:""}),_=c({currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],newPassword:[{required:!0,validator:(n,e,s)=>{e===""?s(new Error("请输入密码")):(r.confirmPassword!==""&&a.value&&a.value.validateField("confirmPassword"),s())},trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],confirmPassword:[{required:!0,validator:(n,e,s)=>{e===""?s(new Error("请再次输入密码")):e!==r.newPassword?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]}),g=async()=>{a.value&&await a.value.validate(async n=>{if(n){i.value=!0;try{const{error:e}=await y.auth.updateUser({password:r.newPassword});if(e)throw e;p.success("密码修改成功"),m()}catch(e){console.error("修改密码失败:",e),p.error(e.message||"修改密码失败")}finally{i.value=!1}}})},m=()=>{a.value&&a.value.resetFields()};return(n,e)=>{const s=u("el-input"),d=u("el-form-item"),w=u("el-button"),v=u("el-form");return E(),C("div",h,[o(v,{ref_key:"formRef",ref:a,model:r,rules:_,"label-width":"120px",class:"password-form",height:"300px"},{default:t(()=>[o(d,{label:"当前密码",prop:"currentPassword"},{default:t(()=>[o(s,{modelValue:r.currentPassword,"onUpdate:modelValue":e[0]||(e[0]=l=>r.currentPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"新密码",prop:"newPassword"},{default:t(()=>[o(s,{modelValue:r.newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>r.newPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"确认新密码",prop:"confirmPassword"},{default:t(()=>[o(s,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>r.confirmPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[o(w,{type:"primary",onClick:g,loading:i.value},{default:t(()=>e[3]||(e[3]=[P("确认修改")])),_:1},8,["loading"]),o(w,{onClick:m},{default:t(()=>e[4]||(e[4]=[P("重置")])),_:1})]),_:1})]),_:1},8,["model","rules"])])}}}),H=V(F,[["__scopeId","data-v-9080aac9"]]);export{H as default};

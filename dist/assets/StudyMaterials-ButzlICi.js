import{_ as j,a as O,b as W,c as R,d as A,e as G,f as H,g as J,h as K,i as X,j as Z,k as Q,l as Y}from"./zip-KiBfUjci.js";import{b as ee,s as w,_ as te}from"./index-Dc3VxstI.js";import{x as ae,r,aF as se,X as le,j as oe,y as b,P as n,I as ne,H as i,ag as s,aq as ce,G as f,O as k,a6 as z,L as re,J as ie,z as _,A as S,M as _e}from"./vendor-COQJj1AX.js";import{E as pe}from"./elementPlus-Dv7g5dxn.js";import"./supabase-Bqqw4QDB.js";const ue={class:"study"},de=["onClick"],ge={class:"study-content-title hide-text-2"},ve=ae({__name:"StudyMaterials",setup(me){const v=r([]),p=r(!1),u=r(""),d=r(""),V=r("desc"),y=se(),C=r(y.query.platform||"google"),P=r(y.query.chapter||"base"),c=le({page:1,pageSize:10,total:0}),q=t=>{c.page=t.page,c.pageSize=t.pageSize,m()},m=async()=>{try{p.value=!0;let t=w.from("study_materials").select("*",{count:"exact"}).eq("platform",C.value).eq("chapter",P.value);u.value&&(t=t.ilike("title",`%${u.value}%`)),d.value&&(t=t.eq("type",d.value));const{data:e,error:o,count:g}=await t.order("created_at",{ascending:V.value==="asc"}).range((c.page-1)*c.pageSize,c.page*c.pageSize-1);if(o)throw o;v.value=e,c.total=g!==null?g:0}catch(t){pe.error(`数据加载失败: ${t}`)}finally{p.value=!1}},D=async t=>{try{const{data:e,error:o}=await w.from("material_contents").select("*").in("material_id",[t]);if(o)throw o;console.log(e[0].content),window.open(e[0].content,"_blank")}catch(e){return console.error("查询失败:",e),null}};oe(()=>{m()});const M=t=>{const e=x.find(o=>o.icon===t);return e?e.src:x[0].src},U=[{value:"image",label:"图片"},{value:"video",label:"视频"},{value:"txt",label:"文本"},{value:"pdf",label:"PDF"},{value:"ppt",label:"PPT"},{value:"link",label:"链接"},{value:"word",label:"Word"},{value:"excel",label:"Excel"},{value:"zip",label:"压缩包"}],l=t=>new URL(Object.assign({"/src/assets/icons/excel.png":Y,"/src/assets/icons/file.png":Q,"/src/assets/icons/image.png":Z,"/src/assets/icons/link.png":X,"/src/assets/icons/music.png":K,"/src/assets/icons/pdf.png":J,"/src/assets/icons/ppt.png":H,"/src/assets/icons/reading.png":G,"/src/assets/icons/select.png":A,"/src/assets/icons/txt.png":R,"/src/assets/icons/video.png":W,"/src/assets/icons/word.png":O,"/src/assets/icons/zip.png":j})[`/src/assets/icons/${t}.png`],import.meta.url).href,x=[{icon:"image",label:"图片",src:l("image")},{icon:"pdf",label:"PDF",src:l("pdf")},{icon:"word",label:"Word 文档",src:l("word")},{icon:"excel",label:"Excel 表格",src:l("excel")},{icon:"txt",label:"文本文件",src:l("txt")},{icon:"link",label:"链接",src:l("link")},{icon:"video",label:"视频",src:l("video")},{icon:"zip",label:"ZIP 压缩文件",src:l("zip")},{icon:"ppt",label:"PPT 演示文稿",src:l("ppt")}];return(t,e)=>{const o=s("el-option"),g=s("el-select"),$=s("el-input"),E=s("el-button"),I=s("el-space"),h=s("el-card"),B=s("el-image"),F=s("el-col"),L=s("el-row"),N=s("el-empty"),T=ce("loading");return _(),b("div",ue,[n(h,{class:"study-search",style:{"margin-bottom":"20px"}},{default:i(()=>[n(I,{alignment:"start",size:30},{default:i(()=>[n(g,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),placeholder:"选择文件类型",clearable:"",size:"large",style:{width:"240px"}},{default:i(()=>[(_(),b(k,null,z(U,a=>n(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),n($,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),clearable:"",style:{width:"240px"},placeholder:"请输入文件标题","suffix-icon":"Search",size:"large"},null,8,["modelValue"]),n(E,{type:"primary",size:"large",onClick:e[2]||(e[2]=a=>m())},{default:i(()=>e[3]||(e[3]=[re("搜索")])),_:1})]),_:1})]),_:1}),ne((_(),f(h,{style:{"min-height":"400px"}},{default:i(()=>[n(L,{gutter:40,style:{"row-gap":"30px"}},{default:i(()=>[(_(!0),b(k,null,z(v.value,(a,be)=>(_(),f(F,{xs:12,sm:8,md:6,lg:4},{default:i(()=>[S("div",{class:"grid-content-column",onClick:fe=>D(a.id)},[n(B,{style:{width:"120px",height:"120px"},src:M(a.type),fit:"fill"},null,8,["src"]),S("div",ge,_e(a.title),1)],8,de)]),_:2},1024))),256))]),_:1}),!p.value&&v.value.length===0?(_(),f(N,{key:0,description:"暂无数据"})):ie("",!0)]),_:1})),[[T,p.value]]),n(ee,{pagination:c,onUpdate:q},null,8,["pagination"])])}}}),ze=te(ve,[["__scopeId","data-v-bc788dcb"]]);export{ze as default};

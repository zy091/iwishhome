import{E as z,s as ut,N as ie,u as re,P as $e,F as Te,Q as dt,O as ct,R as mt,S as _t,D as pt,t as vt,c as Ae}from"./elementPlus-7n3J9xVR.js";import{s as x,u as ft,B as gt,e as ht,b as yt}from"./index-BKDCXq68.js";import{x as wt,X as ue,c as te,r as m,j as bt,y as p,P as t,A as o,H as s,ag as v,G as V,J as f,u as g,O as Fe,a6 as qe,L as c,I as kt,aq as Ct,M as h,z as r}from"./vendor-kUynFKsh.js";import"./supabase-Dk90AXsH.js";const Vt=i=>i===0||i===1||i===11,W={async getAllCases(i={}){let u=x.from("case_sharing").select("*",{count:"exact"});if(i.query&&(u=u.or(`title.ilike.%${i.query}%,custom_sharer.ilike.%${i.query}%,custom_department.ilike.%${i.query}%`)),i.category&&i.category!=="all"&&(u=u.eq("category",i.category)),i.startDate&&i.endDate&&(u=u.gte("created_at",i.startDate).lte("created_at",i.endDate)),i.viewType==="my"){const{data:{user:E}}=await x.auth.getUser();E&&(u=u.eq("created_by",E.id))}i.showStatus!==void 0?u=u.eq("is_show",i.showStatus==="true"):u=u.eq("is_show",!0);const y=((i.page||1)-1)*(i.pageSize||10),k=y+(i.pageSize||10)-1,{data:b,error:C,count:Y}=await u.order("created_at",{ascending:!1}).range(y,k);if(C)throw C;return{data:b,total:Y||0}},async getCase(i){const{data:u,error:y}=await x.from("case_sharing").select("*").eq("id",i).single();if(y)throw y;return u},async createCase(i){const{data:{user:u}}=await x.auth.getUser();if(!u)throw new Error("User not authenticated");const{data:y,error:k}=await x.from("user_profiles").select("full_name, organization_id").eq("user_id",u.id).single();if(k)throw k;const{data:b,error:C}=await x.from("case_sharing").insert({...i,created_by:u.id,created_by_name:y.full_name||u.email,organization_id:y.organization_id}).select().single();if(C)throw C;return b},async updateCase(i,u){const{data:y,error:k}=await x.from("case_sharing").update(u).eq("id",i).select().single();if(k)throw k;return y},async deleteCase(i){const{error:u}=await x.from("case_sharing").delete().eq("id",i);if(u)throw u},async uploadFile(i,u){const y=`${new Date().getTime()}_${i.name}`,k=`${u}/${y}`,{data:b,error:C}=await x.storage.from("materials").upload(k,i);if(C)throw C;const{data:{publicUrl:Y}}=x.storage.from("materials").getPublicUrl(k);return{url:Y,filename:y}}},xt={class:"layout"},zt={class:"layout-title"},Dt={class:"status-tabs"},St={class:"cases-content"},Ut={class:"card-header"},$t={class:"header-actions"},Tt={style:{"font-size":"14px",color:"#909399"}},At={class:"month-info"},Ft={key:0,class:"month-item"},qt={class:"month-text"},Et={key:1,class:"month-empty"},Bt={class:"sharer-dept-info"},Mt={key:0,class:"sharer-item"},Nt={class:"sharer-text"},Lt={key:1,class:"dept-item"},Pt={class:"dept-text"},Yt={key:2,class:"sharer-dept-empty"},jt={key:2},Ot={class:"dialog-content"},Ht={class:"case-details"},Rt={class:"case-header"},Gt={class:"case-title"},Qt={class:"case-meta"},Jt={class:"meta-item"},Wt={class:"meta-item"},Xt={class:"meta-item"},Kt={class:"case-section"},Zt=["innerHTML"],It={key:0,class:"case-section"},ea={class:"attachment-box"},ta={class:"attachment-name"},aa={key:1,class:"case-section"},la={class:"link-box"},sa={class:"link-url"},oa={key:2,class:"case-section"},na={class:"custom-info"},ia={key:0,class:"custom-item"},ra={class:"custom-value"},ua={key:1,class:"custom-item"},da={class:"custom-value"},ca={key:2,class:"custom-item"},ma={class:"custom-value"},_a={class:"dialog-footer"},pa={class:"attachment-preview"},va=["src"],fa=["src"],ga={key:2,class:"attachment-download"},ha={class:"dialog-footer"},ya={class:"fullscreen-preview"},wa=["src"],ba=["src"],ka={class:"share-disk-dialog"},Ca={class:"disk-options"},Va={class:"button-content"},xa={class:"button-content"},za={class:"dialog-footer"},Da={class:"dialog-footer"},Sa=wt({__name:"CaseSharing",setup(i){const u=ue([{name:"分享分享",path:"/system/case-sharing"}]),y=ft(),k=te(()=>{var a;return((a=y.user)==null?void 0:a.user_id)||""}),b=te(()=>Vt(Number(y.roleId))),C=m(!1),Y=m([]),E=m(!1),j=m(!1),d=m(null),ae=m(""),T=m([]),X=m(""),K=m(!1),Z=m("all"),B=m([]),le=m(),M=m(!1),I=m(""),H=m(!1),A=m(""),O=m(""),se=m(!1),R=m(!1),de=a=>{let e="";a==="ugospro"?e="https://192-168-1-37.iwish.direct.ug.link:9443/desktop/?os=ugospro#/login/account":a==="iwish"&&(e="https://iwish.cn57.ug.link/invite/?code%3D549A366803426187%26LANG%3Dzh-CN"),e&&(window.open(e,"_blank"),R.value=!1)},n=ue({id:"",title:"",content:"",category:"",is_show:!0,attachment_url:"",attachment_name:"",attachment_type:"",link_url:"",custom_month:"",custom_sharer:"",custom_department:""}),Ee={title:[{required:!0,message:"请输入分享标题",trigger:"blur"},{min:2,max:100,message:"标题长度应在2到100个字符之间",trigger:"blur"}],category:[{required:!0,message:"请选择分享类型",trigger:"change"}],content:[{required:!1,message:"请输入分享内容",trigger:"blur"},{min:2,max:1e4,message:"内容长度应在8到10000个字符之间",trigger:"blur"}]},ce=[{label:"广告",value:"advertising"},{label:"素材",value:"material"},{label:"日常运营",value:"daily_operation"},{label:"客户案例",value:"customer_case"},{label:"技术分享",value:"technical"},{label:"其他",value:"other"}],F=ue({page:1,pageSize:10,total:0}),ee=m([]),U=m(null),Be=[{text:"最近一周",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,a]}},{text:"最近一个月",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,a]}},{text:"最近三个月",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,a]}}],oe=te(()=>O.value?O.value.startsWith("image/"):!1),ne=te(()=>O.value?O.value==="application/pdf":!1),Me=a=>{switch(a){case"advertising":return"primary";case"material":return"success";case"daily_operation":return"warning";case"customer_case":return"danger";case"technical":return"info";case"other":return"";default:return"info"}},me=a=>{switch(a){case"advertising":return"广告";case"material":return"素材";case"daily_operation":return"日常运营";case"customer_case":return"客户分享";case"technical":return"技术分享";case"other":return"其他";default:return a||"未知"}},Ne=a=>b.value?!0:a.created_by===k.value,Le=a=>b.value?!0:a.created_by===k.value,Pe=a=>{F.page=a.page,F.pageSize=a.pageSize,N()},N=async()=>{C.value=!0;const a=T.value!=null&&T.value[0]!=null?T.value[0].toDateString():"",e=T.value!=null&&T.value[1]!=null?T.value[1].toDateString():"";try{const D=await W.getAllCases({query:ae.value,startDate:a,endDate:e,page:F.page,pageSize:F.pageSize,category:I.value!==""?I.value:void 0,showStatus:b.value&&X.value!==""?X.value:void 0,viewType:Z.value});Y.value=D.data,F.total=D.total}catch(D){z.error("搜索分享失败"),console.error("搜索分享失败:",D)}finally{C.value=!1}},Ye=async a=>{E.value=!0,d.value=a},je=a=>{a.attachment_url&&(A.value=a.attachment_url,O.value=ve(a.attachment_name),H.value=!0)},Oe=()=>{var a;(a=d.value)!=null&&a.attachment_url&&(A.value=d.value.attachment_url,O.value=ve(d.value.attachment_name),H.value=!0)},He=()=>{A.value&&window.open(A.value,"_blank")},_e=()=>{se.value=!0},pe=a=>{a&&window.open(a,"_blank")},ve=a=>{if(!a)return"";const e=Re(a);return["jpg","jpeg","png","gif","webp"].includes(e)?"image/"+e:e==="pdf"?"application/pdf":""},Re=a=>{if(!a)return"";const e=a.split(".");return e.length>1?e[e.length-1].toLowerCase():""},Ge=()=>{M.value=!1,j.value=!0,Object.assign(n,{id:"",title:"",content:"",category:"",is_show:!0,attachment_url:"",attachment_name:"",attachment_type:"",link_url:"",custom_month:"",custom_sharer:"",custom_department:""}),ee.value=[],U.value=null},Qe=a=>{M.value=!0,j.value=!0,Object.assign(n,{id:a.id,title:a.title,content:a.content,category:a.category,is_show:a.is_show,attachment_url:a.attachment_url,attachment_name:a.attachment_name,attachment_type:a.attachment_type,link_url:a.link_url,custom_month:a.custom_month,custom_sharer:a.custom_sharer,custom_department:a.custom_department}),ee.value=[],U.value=null},Je=a=>{B.value=a},We=a=>{const e=["application/pdf","application/msword","text/plain","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/png","image/gif","image/webp"],D=a.raw&&e.includes(a.raw.type),G=a.raw&&a.raw.size/1024/1024<10;if(!D)return z.error("文件类型不支持！"),!1;if(!G)return z.error("文件大小超过 10MB 限制！"),!1;U.value=a.raw,console.log("Selected file:",U.value)},Xe=async a=>{if(!a)throw new Error("No file selected");const e=a.name.split(".").pop(),G=`casesharing/${`${Date.now()}-${Math.random().toString(36).substring(2)}.${e}`}`,{data:q,error:L}=await x.storage.from("materials").upload(G,a);if(L)throw L;const{data:Q}=x.storage.from("materials").getPublicUrl(q.path);return Q.publicUrl},Ke=async()=>{le.value&&await le.value.validate(async a=>{if(a){K.value=!0;try{if(U.value)try{const e=await Xe(U.value);n.attachment_url=e,n.attachment_name=U.value.name,n.attachment_type=U.value.type}catch(e){z.error(`文件上传失败: ${e.message||"未知错误"}`),K.value=!1;return}M.value?(await W.updateCase(n.id,{title:n.title,content:n.content,category:n.category,is_show:n.is_show,attachment_url:n.attachment_url,attachment_name:n.attachment_name,attachment_type:n.attachment_type,link_url:n.link_url,custom_month:n.custom_month,custom_sharer:n.custom_sharer,custom_department:n.custom_department}),z.success("分享已更新")):(await W.createCase({title:n.title,content:n.content,category:n.category,is_show:n.is_show,attachment_url:n.attachment_url,attachment_name:n.attachment_name,attachment_type:n.attachment_type,link_url:n.link_url,custom_month:n.custom_month,custom_sharer:n.custom_sharer,custom_department:n.custom_department}),z.success("分享已创建")),j.value=!1,N(),ee.value=[],U.value=null}catch(e){z.error(M.value?"更新分享失败":"创建分享失败"),console.error(M.value?"更新分享失败:":"创建分享失败:",e)}finally{K.value=!1}}})},Ze=async a=>{try{await Ae.confirm(`确定要删除 "${a.title}" 这个分享吗？`,"提示",{type:"warning"}),await W.deleteCase(a.id),z.success("删除成功"),N()}catch(e){e!=="cancel"&&(z.error("删除失败"),console.error("删除失败:",e))}},Ie=async()=>{if(B.value.length!==0)try{await Ae.confirm(`确定要删除选中的 ${B.value.length} 个分享吗？此操作不可恢复。`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=B.value.map(e=>W.deleteCase(e.id));await Promise.all(a),z.success(`成功删除 ${B.value.length} 个分享`),B.value=[],N()}catch(a){a!=="cancel"&&(console.error("批量删除分享失败:",a),z.error("批量删除失败"))}},et=()=>{R.value=!0},tt=a=>{Z.value=a,F.page=1,N()};return bt(()=>{N()}),(a,e)=>{const D=v("el-tab-pane"),G=v("el-tabs"),q=v("el-input"),L=v("el-option"),Q=v("el-select"),fe=v("el-date-picker"),_=v("el-button"),at=v("el-space"),ge=v("el-card"),S=v("el-table-column"),w=v("el-icon"),he=v("el-tag"),lt=v("el-button-group"),st=v("el-empty"),ot=v("el-table"),J=v("el-dialog"),$=v("el-form-item"),nt=v("el-upload"),it=v("el-switch"),rt=Ct("loading");return r(),p("div",xt,[t(gt,{breadcrumb:u},null,8,["breadcrumb"]),o("div",zt,[e[25]||(e[25]=o("h1",{class:"title"},"知识分享",-1)),o("div",Dt,[t(G,{class:"demo-tabs",modelValue:Z.value,"onUpdate:modelValue":e[0]||(e[0]=l=>Z.value=l),onTabChange:tt},{default:s(()=>[t(D,{name:"all",label:"全部分享"}),t(D,{name:"my",label:"我的分享"})]),_:1},8,["modelValue"])])]),t(ge,{shadow:"always",style:{"margin-bottom":"20px"}},{default:s(()=>[t(at,{wrap:"",alignment:"start",size:30},{default:s(()=>[t(q,{modelValue:ae.value,"onUpdate:modelValue":e[1]||(e[1]=l=>ae.value=l),style:{width:"400px"},placeholder:"搜索标题、分享人、部门（支持模糊搜索）","suffix-icon":g(ut),size:"large",clearable:""},null,8,["modelValue","suffix-icon"]),t(Q,{modelValue:I.value,"onUpdate:modelValue":e[2]||(e[2]=l=>I.value=l),placeholder:"分享类型",clearable:"",style:{width:"180px"},size:"large"},{default:s(()=>[(r(),p(Fe,null,qe(ce,l=>t(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(fe,{modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=l=>T.value=l),type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:Be,size:"large"},null,8,["modelValue"]),b.value?(r(),V(Q,{key:0,modelValue:X.value,"onUpdate:modelValue":e[4]||(e[4]=l=>X.value=l),placeholder:"选择展示状态",style:{width:"160px"},size:"large",clearable:""},{default:s(()=>[t(L,{label:"显示",value:"true"}),t(L,{label:"隐藏",value:"false"})]),_:1},8,["modelValue"])):f("",!0),t(_,{type:"primary",size:"large",onClick:N},{default:s(()=>e[26]||(e[26]=[c("搜索")])),_:1}),t(_,{type:"success",size:"large",onClick:Ge},{default:s(()=>e[27]||(e[27]=[c("添加分享")])),_:1})]),_:1})]),_:1}),o("div",St,[t(ge,{style:{"min-height":"400px"}},{header:s(()=>[o("div",Ut,[e[30]||(e[30]=c(" 分享列表 ")),o("div",$t,[t(_,{type:"success",onClick:et},{default:s(()=>e[28]||(e[28]=[c(" 进入共享盘 ")])),_:1}),b.value?(r(),V(_,{key:0,type:"danger",disabled:!B.value.length,onClick:Ie},{default:s(()=>e[29]||(e[29]=[c(" 批量删除 ")])),_:1},8,["disabled"])):f("",!0),o("div",Tt,"共计"+h(F.total)+"条数据",1)])])]),default:s(()=>[kt((r(),V(ot,{data:Y.value,onSelectionChange:Je,"scrollbar-always-on":!0,style:{width:"100%"}},{default:s(()=>[b.value?(r(),V(S,{key:0,type:"selection",width:"55",fixed:"left"})):f("",!0),t(S,{label:"分享月份",width:"120"},{default:s(({row:l})=>[o("div",At,[l.custom_month?(r(),p("div",Ft,[t(w,{color:"#E6A23C",size:"14"},{default:s(()=>[t(g(ie))]),_:1}),o("span",qt,h(l.custom_month),1)])):(r(),p("div",Et,e[31]||(e[31]=[o("span",{class:"empty-text"},"-",-1)])))])]),_:1}),t(S,{prop:"title",label:"标题","min-width":"200"}),t(S,{label:"分享人/部门","min-width":"150"},{default:s(({row:l})=>[o("div",Bt,[l.custom_sharer?(r(),p("div",Mt,[t(w,{color:"#67C23A",size:"14"},{default:s(()=>[t(g(re))]),_:1}),o("span",Nt,h(l.custom_sharer),1)])):f("",!0),l.custom_department?(r(),p("div",Lt,[t(w,{color:"#F56C6C",size:"14"},{default:s(()=>[t(g($e))]),_:1}),o("span",Pt,h(l.custom_department),1)])):f("",!0),!l.custom_sharer&&!l.custom_department?(r(),p("div",Yt,e[32]||(e[32]=[o("span",{class:"empty-text"},"-",-1)]))):f("",!0)])]),_:1}),t(S,{prop:"category",label:"类型",width:"100"},{default:s(({row:l})=>[t(he,{type:Me(l.category),size:"large"},{default:s(()=>[c(h(me(l.category)),1)]),_:2},1032,["type"])]),_:1}),t(S,{label:"附件/链接",width:"100"},{default:s(({row:l})=>[l.attachment_url?(r(),V(_,{key:0,type:"primary",link:"",onClick:P=>je(l)},{default:s(()=>[t(w,{color:"#409EFF",size:"18"},{default:s(()=>[t(g(Te))]),_:1})]),_:2},1032,["onClick"])):l.link_url?(r(),V(_,{key:1,type:"primary",link:"",onClick:P=>pe(l.link_url)},{default:s(()=>[t(w,{color:"#67C23A",size:"18"},{default:s(()=>[t(g(dt))]),_:1})]),_:2},1032,["onClick"])):(r(),p("span",jt,"-"))]),_:1}),b.value?(r(),V(S,{key:1,prop:"is_show",label:"展示状态",width:"80"},{default:s(({row:l})=>[t(he,{type:l.is_show?"success":"danger",size:"large"},{default:s(()=>[c(h(l.is_show?"显示":"隐藏"),1)]),_:2},1032,["type"])]),_:1})):f("",!0),t(S,{prop:"created_at",label:"创建时间",width:"150"},{default:s(({row:l})=>[c(h(new Date(l.created_at).toLocaleString()),1)]),_:1}),b.value?(r(),V(S,{key:2,prop:"created_by_name",label:"创建人",width:"80"})):f("",!0),t(S,{label:"操作",width:"230",fixed:"right"},{default:s(({row:l})=>[t(lt,null,{default:s(()=>[t(_,{type:"primary",onClick:P=>Ye(l)},{default:s(()=>e[33]||(e[33]=[c("查看")])),_:2},1032,["onClick"]),Ne(l)?(r(),V(_,{key:0,type:"warning",onClick:P=>Qe(l)},{default:s(()=>e[34]||(e[34]=[c("编辑")])),_:2},1032,["onClick"])):f("",!0),Le(l)?(r(),V(_,{key:1,type:"danger",onClick:P=>Ze(l)},{default:s(()=>e[35]||(e[35]=[c("删除")])),_:2},1032,["onClick"])):f("",!0)]),_:2},1024)]),_:1}),t(st,null,{description:s(()=>e[36]||(e[36]=[c(" 暂无分享数据 ")])),_:1})]),_:1},8,["data"])),[[rt,C.value]])]),_:1}),t(ht,{pagination:F,"onUpdate:pagination":Pe},null,8,["pagination"]),t(J,{title:"分享详情",modelValue:E.value,"onUpdate:modelValue":e[7]||(e[7]=l=>E.value=l),width:"60%","close-on-click-modal":!1,top:"5vh",class:"case-detail-dialog"},{footer:s(()=>[o("span",_a,[t(_,{onClick:e[6]||(e[6]=l=>E.value=!1)},{default:s(()=>e[47]||(e[47]=[c("关闭")])),_:1})])]),default:s(()=>{var l,P,ye,we,be,ke,Ce,Ve,xe,ze,De,Se,Ue;return[o("div",Ot,[o("div",Ht,[o("div",Rt,[o("h2",Gt,h(((l=d.value)==null?void 0:l.title)||"无标题"),1),o("div",Qt,[o("span",Jt,[t(w,null,{default:s(()=>[t(g(re))]),_:1}),o("span",null,h(((P=d.value)==null?void 0:P.created_by_name)||"未知用户"),1)]),o("span",Wt,[t(w,null,{default:s(()=>[t(g(ie))]),_:1}),o("span",null,h(d.value?new Date((ye=d.value)==null?void 0:ye.created_at).toLocaleString():"未知时间"),1)]),o("span",Xt,[t(w,null,{default:s(()=>[t(g(ct))]),_:1}),o("span",null,h(me(((we=d.value)==null?void 0:we.category)||"")),1)])])]),o("div",Kt,[e[37]||(e[37]=o("div",{class:"section-title"},"内容",-1)),o("div",{class:"case-content",style:{padding:"10px"},innerHTML:((be=d.value)==null?void 0:be.content)||"无内容"},null,8,Zt)]),(ke=d.value)!=null&&ke.attachment_url?(r(),p("div",It,[e[39]||(e[39]=o("div",{class:"section-title"},"附件",-1)),o("div",ea,[t(w,{color:"#409EFF",size:"16"},{default:s(()=>[t(g(Te))]),_:1}),o("span",ta,h(d.value.attachment_name),1),t(_,{type:"primary",size:"small",onClick:Oe},{default:s(()=>e[38]||(e[38]=[c("查看附件")])),_:1})])])):f("",!0),(Ce=d.value)!=null&&Ce.link_url?(r(),p("div",aa,[e[42]||(e[42]=o("div",{class:"section-title"},"相关链接",-1)),o("div",la,[t(w,{color:"#67C23A",size:"16"},{default:s(()=>e[40]||(e[40]=[o("link",null,null,-1)])),_:1}),o("span",sa,h(d.value.link_url),1),t(_,{type:"success",size:"small",onClick:e[5]||(e[5]=Ua=>pe(d.value.link_url))},{default:s(()=>e[41]||(e[41]=[c("打开链接")])),_:1})])])):f("",!0),(Ve=d.value)!=null&&Ve.custom_month||(xe=d.value)!=null&&xe.custom_sharer||(ze=d.value)!=null&&ze.custom_department?(r(),p("div",oa,[e[46]||(e[46]=o("div",{class:"section-title"},"分享信息",-1)),o("div",na,[(De=d.value)!=null&&De.custom_month?(r(),p("div",ia,[t(w,{color:"#E6A23C",size:"16"},{default:s(()=>[t(g(ie))]),_:1}),e[43]||(e[43]=o("span",{class:"custom-label"},"月份：",-1)),o("span",ra,h(d.value.custom_month),1)])):f("",!0),(Se=d.value)!=null&&Se.custom_sharer?(r(),p("div",ua,[t(w,{color:"#67C23A",size:"16"},{default:s(()=>[t(g(re))]),_:1}),e[44]||(e[44]=o("span",{class:"custom-label"},"分享人：",-1)),o("span",da,h(d.value.custom_sharer),1)])):f("",!0),(Ue=d.value)!=null&&Ue.custom_department?(r(),p("div",ca,[t(w,{color:"#F56C6C",size:"16"},{default:s(()=>[t(g($e))]),_:1}),e[45]||(e[45]=o("span",{class:"custom-label"},"部门：",-1)),o("span",ma,h(d.value.custom_department),1)])):f("",!0)])])):f("",!0)])])]}),_:1},8,["modelValue"]),t(J,{modelValue:H.value,"onUpdate:modelValue":e[9]||(e[9]=l=>H.value=l),title:"附件预览",width:"80%","destroy-on-close":""},{footer:s(()=>[o("span",ha,[t(_,{onClick:e[8]||(e[8]=l=>H.value=!1)},{default:s(()=>e[50]||(e[50]=[c("关闭")])),_:1}),oe.value||ne.value?(r(),V(_,{key:0,type:"primary",onClick:_e},{default:s(()=>e[51]||(e[51]=[c(" 全屏查看 ")])),_:1})):f("",!0)])]),default:s(()=>[o("div",pa,[oe.value?(r(),p("img",{key:0,src:A.value,class:"attachment-image",onClick:_e},null,8,va)):ne.value?(r(),p("iframe",{key:1,src:A.value,class:"attachment-frame"},null,8,fa)):(r(),p("div",ga,[e[49]||(e[49]=o("p",null,"无法预览此类型的文件，请下载后查看",-1)),t(_,{type:"primary",onClick:He},{default:s(()=>e[48]||(e[48]=[c("下载附件")])),_:1})]))])]),_:1},8,["modelValue"]),t(J,{modelValue:se.value,"onUpdate:modelValue":e[10]||(e[10]=l=>se.value=l),title:"全屏预览",width:"100%",top:"0","show-close":!0,"destroy-on-close":"",class:"fullscreen-dialog"},{default:s(()=>[o("div",ya,[oe.value?(r(),p("img",{key:0,src:A.value,class:"fullscreen-image"},null,8,wa)):ne.value?(r(),p("iframe",{key:1,src:A.value,class:"fullscreen-frame"},null,8,ba)):f("",!0)])]),_:1},8,["modelValue"]),t(J,{modelValue:R.value,"onUpdate:modelValue":e[14]||(e[14]=l=>R.value=l),title:"登录&注册共享盘",width:"400px",center:""},{footer:s(()=>[o("span",za,[t(_,{onClick:e[13]||(e[13]=l=>R.value=!1)},{default:s(()=>e[54]||(e[54]=[c("取消")])),_:1})])]),default:s(()=>[o("div",ka,[o("div",Ca,[t(_,{type:"primary",size:"large",class:"disk-button",onClick:e[11]||(e[11]=l=>de("ugospro"))},{default:s(()=>[o("div",Va,[t(w,{size:"24"},{default:s(()=>[t(g(mt))]),_:1}),e[52]||(e[52]=o("span",null,"登录共享盘",-1))])]),_:1}),t(_,{type:"success",size:"large",class:"disk-button",onClick:e[12]||(e[12]=l=>de("iwish"))},{default:s(()=>[o("div",xa,[t(w,{size:"24"},{default:s(()=>[t(g(_t))]),_:1}),e[53]||(e[53]=o("span",null,"注册共享盘账号",-1))])]),_:1})])])]),_:1},8,["modelValue"]),t(J,{title:M.value?"编辑分享":"知识分享",modelValue:j.value,"onUpdate:modelValue":e[24]||(e[24]=l=>j.value=l),width:"50%","close-on-click-modal":!1},{footer:s(()=>[o("span",Da,[t(_,{onClick:e[23]||(e[23]=l=>j.value=!1)},{default:s(()=>e[57]||(e[57]=[c("取消")])),_:1}),t(_,{type:"primary",onClick:Ke,loading:K.value},{default:s(()=>[c(h(M.value?"更新":"创建"),1)]),_:1},8,["loading"])])]),default:s(()=>[t(g(pt),{model:n,rules:Ee,ref_key:"caseForm",ref:le,"label-width":"80px",style:{"max-width":"800px"}},{default:s(()=>[t($,{label:"标题",prop:"title"},{default:s(()=>[t(q,{modelValue:n.title,"onUpdate:modelValue":e[15]||(e[15]=l=>n.title=l),placeholder:"请输入分享标题"},null,8,["modelValue"])]),_:1}),t($,{label:"类型",prop:"category"},{default:s(()=>[t(Q,{modelValue:n.category,"onUpdate:modelValue":e[16]||(e[16]=l=>n.category=l),placeholder:"选择分享类型",style:{width:"100%"}},{default:s(()=>[(r(),p(Fe,null,qe(ce,l=>t(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t($,{label:"内容",prop:"content"},{default:s(()=>[t(q,{type:"textarea",modelValue:n.content,"onUpdate:modelValue":e[17]||(e[17]=l=>n.content=l),rows:10,placeholder:"请输入分享内容"},null,8,["modelValue"])]),_:1}),t($,{label:"附件"},{default:s(()=>[t(nt,{class:"upload-box","auto-upload":!1,"on-change":We,"file-list":ee.value,limit:1,drag:"",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",multiple:""},{tip:s(()=>e[55]||(e[55]=[o("div",{class:"el-upload__tip"}," 支持 .pdf, .doc, .docx, .xls, .xlsx, 图片等格式文件，不超过10MB ",-1)])),default:s(()=>[t(w,{class:"el-icon--upload"},{default:s(()=>[t(g(vt))]),_:1}),e[56]||(e[56]=o("div",{class:"el-upload__text"},[c(" 拖拽文件或"),o("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1}),t($,{label:"链接"},{default:s(()=>[t(q,{modelValue:n.link_url,"onUpdate:modelValue":e[18]||(e[18]=l=>n.link_url=l),placeholder:"请输入相关链接（可选）"},null,8,["modelValue"])]),_:1}),t($,{label:"分享月份"},{default:s(()=>[t(fe,{modelValue:n.custom_month,"onUpdate:modelValue":e[19]||(e[19]=l=>n.custom_month=l),type:"month",placeholder:"选择月份（可选）",format:"YYYY年MM月","value-format":"YYYY年MM月",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t($,{label:"分享人"},{default:s(()=>[t(q,{modelValue:n.custom_sharer,"onUpdate:modelValue":e[20]||(e[20]=l=>n.custom_sharer=l),placeholder:"请输入自定义分享人（可选）"},null,8,["modelValue"])]),_:1}),t($,{label:"分享部门"},{default:s(()=>[t(q,{modelValue:n.custom_department,"onUpdate:modelValue":e[21]||(e[21]=l=>n.custom_department=l),placeholder:"请输入分享部门（可选）"},null,8,["modelValue"])]),_:1}),b.value?(r(),V($,{key:0,label:"状态"},{default:s(()=>[t(it,{modelValue:n.is_show,"onUpdate:modelValue":e[22]||(e[22]=l=>n.is_show=l),"active-text":"显示","inactive-text":"隐藏"},null,8,["modelValue"])]),_:1})):f("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])])}}}),qa=yt(Sa,[["__scopeId","data-v-0abd0852"]]);export{qa as default};
